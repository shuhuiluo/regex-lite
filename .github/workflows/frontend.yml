name: Frontend CI

on:
    push:
        branches: [ main ]
    pull_request:
        branches: [ main ]

jobs:
    frontend-ci:
        runs-on: ubuntu-latest

        steps:
            -   name: Checkout code
                uses: actions/checkout@v4

            -   name: Setup Bun
                uses: oven-sh/setup-bun@v2

            -   name: Cache dependencies
                uses: actions/cache@v4
                with:
                    path: web/node_modules
                    key: ${{ runner.os }}-bun-${{ hashFiles('web/bun.lock') }}
                    restore-keys: |
                        ${{ runner.os }}-bun-

            -   name: Install dependencies
                run: cd web && bun install

            -   name: Type checking
                run: cd web && bun run type-check

            -   name: Run linting
                run: cd web && bun run lint

            -   name: Build production bundle
                run: cd web && bun run build
